<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOSTON JASTIP</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Setting the default font to Inter */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7; /* Light gray background */
        }
        /* Custom class to hide elements */
        .hidden-view {
            display: none;
        }
        /* Style for the active variant color selector */
        .variant-thumbnail.active {
            border: 4px solid #4f46e5; /* Tailwind indigo-600 */
        }
        /* Style for the active image in the side gallery */
        .gallery-thumbnail-btn.active-gallery {
            border: 3px solid #10b981; /* Tailwind emerald-500 for distinction */
            opacity: 1;
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }
    </style>
</head>
<body class="min-h-screen antialiased">

    <!-- Header Section -->
    <header class="bg-indigo-700 shadow-xl p-6 md:p-10">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-extrabold text-white mb-2">
                BOSTON JASTIP
            </h1>
            <p class="text-indigo-200 text-lg">
                Jasa Titip dari US ke Indonesia.
            </p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">

        <!-- 1. Catalog Grid View (Default) -->
        <div id="catalog-grid-view">
            <div id="catalog-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Product cards will be injected here by JavaScript -->
            </div>
        </div>

        <!-- 2. Product Details View (Hidden by default) -->
        <div id="details-view" class="hidden-view">
            <!-- Back Button -->
            <button onclick="showCatalogGrid()" class="flex items-center text-indigo-600 hover:text-indigo-800 transition duration-150 mb-6 font-medium">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                Back to Catalog
            </button>
            <div id="product-details-container" class="bg-white rounded-xl shadow-2xl p-6 md:p-10">
                <!-- Detailed product information will be injected here -->
            </div>
        </div>

    </main>

    <script>
        // --- MOCK CATALOG DATA (Price included in variants for dynamic updates) ---
        const products = [
            {
                id: "nolita_19",
                name: "Coach - Nolita 19",
                price: "Rp 2.500.000", // Default price (used if no variants selected/listed)
                // Note: 'images' array is replaced by 'media' array of objects
                variants: [
                    {
                        id: "nolita_19_1",
                        color: "signature canvas/Gold/Sand/Chalk",
                        price: "Rp 2.500.000",
                        media: [ // ARRAY OF MEDIA OBJECTS (images and videos)
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a0?$desktopProduct$", alt: "image1" }, 
                            { type: 'video', url: "https://assets.coach.com/na/media/pdp/spin_cw426_imxdm_v2_p3.mp4", alt: "360 Spin" }, 
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a99?$desktopProduct$", alt: "image2" },
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a10?$desktopProduct$", alt: "image3" },
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a6?$desktopProduct$", alt: "image4" },
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a8?$desktopProduct$", alt: "image5" },
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a3?$desktopProduct$", alt: "image6" },
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a92?$desktopProduct$", alt: "image7" },
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cw426_imxdm_a91?$desktopProduct$", alt: "image8" },
                        ],
                    },
                    {
                        id: "nolita_19_2",
                        color: "smooth leather/Gold",
                        price: "Rp 2.650.000",
                        media: [
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/cci92_immrn_a0?$desktopProduct$", alt: "Smooth Leather Primary" }, 
                            { type: 'image', url: "https://placehold.co/800x600/4c0519/ffffff?text=Smooth+Leather+Side+View", alt: "Smooth Leather Side" },
                            { type: 'image', url: "https://placehold.co/800x600/4c0519/ffffff?text=Smooth+Leather+Back", alt: "Smooth Leather Back" },
                        ],
                    },
                    {
                        id: "nolita_19_3",
                        color: "novelty leather/Silver",
                        price: "Rp 2.700.000",
                        media: [
                            { type: 'image', url: "https://coach.scene7.com/is/image/Coach/ccf58_sva47_a0?$desktopProduct$", alt: "Novelty Leather Primary" }, 
                            { type: 'image', url: "https://placehold.co/800x600/1e40af/ffffff?text=Novelty+Detail+1", alt: "Novelty Detail 1" },
                        ],
                    },
                ]
            },
            {
                id: "echo-headphones",
                name: "Echo Noise-Cancelling Headphones",
                price: "$249.00",
                imageUrl: "https://placehold.co/800x600/4f46e5/ffffff?text=Echo+Headphones+Details",
            },
            {
                id: "zenith-smartwatch",
                name: "Zenith Smartwatch (Series 3)",
                price: "$199.50",
                imageUrl: "https://placehold.co/800x600/10b981/ffffff?text=Zenith+Watch+Details",
            },
            {
                id: "luna-lamp",
                name: "Luna Desk Lamp",
                price: "$65.00",
                imageUrl: "https://placehold.co/800x600/fbbf24/101010?text=Luna+Lamp+Details",
            }
        ];
        // ------------------------------------

        const catalogGridView = document.getElementById('catalog-grid-view');
        const detailsView = document.getElementById('details-view');
        const catalogGrid = document.getElementById('catalog-grid');
        const productDetailsContainer = document.getElementById('product-details-container');

        // Global state to track current product selection
        let currentProductVariants = [];
        let currentProductName = '';
        let currentSelectedVariant = null;

        /**
         * Finds a product object by its unique ID.
         */
        function getProductById(id) {
            return products.find(p => p.id === id);
        }

        /**
         * Switches the view to show the main catalog grid.
         */
        function showCatalogGrid() {
            catalogGridView.classList.remove('hidden-view');
            detailsView.classList.add('hidden-view');
            window.location.hash = '';
        }
        
        /**
         * Updates the WhatsApp order link based on the selected product and variant.
         */
        function updateOrderLink(name, color) {
            const orderLink = document.getElementById('order-link');
            
            // !! IMPORTANT: REPLACE '6281234567890' with your actual WhatsApp number including country code (e.g., 628xxxxxxx) !!
            const whatsappNumber = '16179355621'; 
            
            const selectedItemName = color !== 'N/A' ? `${name} (${color})` : name;
            
            const whatsappMessage = `Halo, saya tertarik untuk Jastip produk ${selectedItemName}.`;
            
            const whatsappUrl = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(whatsappMessage)}`;
            orderLink.href = whatsappUrl;
        }

        /**
         * Renders the small media gallery for the currently selected variant.
         */
        function renderVariantGallery(media, colorName) {
            const galleryContainer = document.getElementById('image-gallery-thumbnails');
            if (!galleryContainer) return;

            const galleryHtml = media.map((item, index) => {
                const activeClass = index === 0 ? 'active-gallery' : '';
                
                // Use the image URL if it's an image, or a custom placeholder for video
                const thumbnailSrc = item.type === 'video'
                    ? 'https://placehold.co/100x100/4f46e5/ffffff?text=VIDEO' 
                    : item.url;
                
                // Add a video icon overlay if it's a video
                const videoOverlay = item.type === 'video' ? `
                    <div class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-30">
                         <!-- Play Icon SVG -->
                        <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd"></path></svg>
                    </div>
                ` : '';

                return `
                    <button
                        onclick="selectGalleryMedia(${index})" 
                        class="gallery-thumbnail-btn w-16 h-16 rounded-lg border-2 border-transparent overflow-hidden ${activeClass} hover:border-indigo-400 transition duration-150 transform hover:scale-105 relative"
                        aria-label="View ${colorName} - ${item.alt}"
                        title="View ${colorName} - ${item.alt}"
                    >
                        <img
                            src="${thumbnailSrc}"
                            alt="${item.alt} thumbnail"
                            class="w-full h-full object-cover opacity-80"
                            onerror="this.onerror=null; this.src='https://placehold.co/100x100/e0e0e0/333333?text=View';"
                        />
                        ${videoOverlay}
                    </button>
                `;
            }).join('');

            galleryContainer.innerHTML = galleryHtml;
        }

        /**
         * Updates the main product view when a gallery thumbnail is clicked.
         * Switches between <img> and <video> elements.
         * @param {number} mediaIndex - The index of the media item in the currentSelectedVariant.media array.
         */
        window.selectGalleryMedia = function(mediaIndex) {
            if (!currentSelectedVariant || !currentSelectedVariant.media) return;

            const selectedMedia = currentSelectedVariant.media[mediaIndex];
            const container = document.getElementById('main-product-media-container');
            
            let mediaHtml = '';

            if (selectedMedia.type === 'video') {
                mediaHtml = `
                    <video 
                        controls 
                        autoplay 
                        loop
                        muted
                        src="${selectedMedia.url}"
                        class="w-full h-full object-contain rounded-lg shadow-lg bg-gray-900"
                        alt="${selectedMedia.alt || 'Product video'}"
                        onerror="this.onerror=null; console.error('Video load error');"
                    >
                        Your browser does not support the video tag.
                    </video>
                `;
            } else { // type === 'image'
                mediaHtml = `
                    <img
                        src="${selectedMedia.url}"
                        alt="${selectedMedia.alt ? currentProductName + ' ' + selectedMedia.alt : 'Product image'}"
                        class="w-full h-full object-contain rounded-lg shadow-lg"
                        onerror="this.onerror=null; this.src='https://placehold.co/800x600/e0e0e0/333333?text=Details+Image+Missing';"
                    >
                `;
            }

            container.innerHTML = mediaHtml;

            // Update active thumbnail styling based on index
            document.querySelectorAll('.gallery-thumbnail-btn').forEach((btn, index) => {
                if (index === mediaIndex) {
                    btn.classList.add('active-gallery');
                } else {
                    btn.classList.remove('active-gallery');
                }
            });
        }


        /**
         * Switches the main product view, gallery, and updates state when a color variant is selected.
         */
        window.selectVariant = function(variantId) {
            const selectedVariant = currentProductVariants.find(v => v.id === variantId);
            if (!selectedVariant) return;
            
            currentSelectedVariant = selectedVariant; // Set global state
            
            // 1. Update the active color thumbnail styling
            document.querySelectorAll('.variant-thumbnail').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById(`variant-btn-${variantId}`).classList.add('active');

            // 2. Update the color name display
            document.getElementById('selected-color-name').textContent = selectedVariant.color;

            // 3. Update the price display
            document.getElementById('product-price').textContent = selectedVariant.price;

            // 4. Update the Order Link
            updateOrderLink(currentProductName, selectedVariant.color);
            
            // 5. RENDER the small image gallery for the new variant
            renderVariantGallery(selectedVariant.media, selectedVariant.color);

            // 6. Select the first item (index 0) in the new media set to update the main view
            selectGalleryMedia(0);
        }

        /**
         * Switches the view to show a single product's details.
         */
        window.showProductDetails = function(productId) {
            const product = getProductById(productId);

            if (!product) {
                console.error('Product not found for ID:', productId);
                showCatalogGrid();
                return;
            }

            currentProductName = product.name;

            // Check if the product has variants
            const isVariantProduct = product.variants && product.variants.length > 0;
            
            // Set initial variant state
            const initialVariant = isVariantProduct ? product.variants[0] : null;
            currentProductVariants = product.variants || [];
            currentSelectedVariant = initialVariant;


            // Determine initial values for rendering
            const initialColorName = isVariantProduct ? initialVariant.color : 'N/A';
            const initialPrice = isVariantProduct ? initialVariant.price : product.price;

            // Generate color variant thumbnail HTML if variants exist
            const variantThumbnailHtml = isVariantProduct ? product.variants.map((variant, index) => {
                const initialActiveClasses = index === 0 ? 'active' : '';
                // Use the first image of the variant for the color selector thumbnail
                const firstImage = variant.media.find(m => m.type === 'image') || variant.media[0];
                const thumbnailUrl = firstImage ? firstImage.url : 'https://placehold.co/100x100/e0e0e0/333333?text=N/A';
                
                return `
                    <button
                        id="variant-btn-${variant.id}"
                        onclick="selectVariant('${variant.id}')"
                        class="variant-thumbnail w-16 h-16 rounded-lg border-2 border-transparent overflow-hidden ${initialActiveClasses} hover:ring-2 hover:ring-indigo-300 transition duration-150 transform hover:scale-105"
                        aria-label="Select ${variant.color} variant"
                        title="${variant.color}"
                    >
                        <img
                            src="${thumbnailUrl}"
                            alt="${variant.color} thumbnail"
                            class="w-full h-full object-cover"
                            onerror="this.onerror=null; this.src='https://placehold.co/100x100/e0e0e0/333333?text=N/A';"
                        />
                    </button>
                `;
            }).join('') : '';

            // Construct the color variant selector block
            const variantSelector = isVariantProduct ? `
                <div class="mb-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Color: <span id="selected-color-name" class="font-normal text-indigo-600">${initialColorName}</span></h4>
                    <div class="flex space-x-3">
                        ${variantThumbnailHtml}
                    </div>
                </div>
            ` : '';

            // 1. Build the HTML for the detail view
            const detailHtml = `
                <div class="md:flex md:space-x-10">
                    
                    <!-- Image Column (Gallery + Main Image) -->
                    <div class="md:w-1/2 mb-6 md:mb-0 flex">
                        <!-- Image Gallery Thumbnails -->
                        ${isVariantProduct ? `<div id="image-gallery-thumbnails" class="flex flex-col space-y-3 mr-4"></div>` : ''}

                        <!-- Main Image / Video will be rendered here -->
                        <div id="main-product-media-container" class="w-full h-auto max-h-[500px] object-contain rounded-lg shadow-lg flex-grow">
                            <!-- Content injected by selectGalleryMedia(0) -->
                        </div>
                    </div>

                    <!-- Details Column -->
                    <div class="md:w-1/2">
                        <h2 class="text-4xl font-bold text-gray-900 mb-4">${product.name}</h2>
                        ${variantSelector} <!-- Color variant selector added here -->
                        <p id="product-price" class="text-3xl font-extrabold text-indigo-700 mb-6">${initialPrice}</p>
                        
                        <!-- ORDERING BUTTON - MANDATORY ACTION -->
                        <div class="mt-8 pt-4 border-t border-gray-200">
                            <h3 class="text-xl font-bold text-gray-900 mb-4">Tertarik?</h3>
                            <p class="text-gray-600 mb-4">Hubungi nomor WA di bawah ini.</p>
                            
                            <a href="#" id="order-link" target="_blank" class="inline-flex items-center justify-center w-full md:w-auto px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-500 hover:bg-green-600 transition duration-150 shadow-xl transform hover:scale-[1.01]">
                                Hubungi
                            </a>
                        </div>

                    </div>
                </div>
            `;

            // 2. Inject and switch the view
            productDetailsContainer.innerHTML = detailHtml;
            catalogGridView.classList.add('hidden-view');
            detailsView.classList.remove('hidden-view');

            // 3. Update URL hash
            window.location.hash = productId;
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // 4. Set the initial order link
            updateOrderLink(product.name, initialColorName);

            // 5. Render the gallery and select the first item
            if (isVariantProduct) {
                renderVariantGallery(initialVariant.media, initialVariant.color);
                selectGalleryMedia(0);
            } else {
                // For non-variant products, manually inject the image
                const container = document.getElementById('main-product-media-container');
                container.innerHTML = `<img src="${product.imageUrl}" alt="${product.name}" class="w-full h-full object-contain rounded-lg shadow-lg">`;
            }
        }


        /**
         * Creates an HTML element for a single product card.
         */
        function createProductCard(product) {
            // Determine the image for the main catalog card. Uses the first image of the first variant if available.
            let cardImageUrl = product.imageUrl;
            let cardPrice = product.price;

            if (product.variants && product.variants.length > 0) {
                const firstMedia = product.variants[0].media.find(m => m.type === 'image') || product.variants[0].media[0];
                if (firstMedia && firstMedia.type === 'image') {
                    cardImageUrl = firstMedia.url;
                } else if (firstMedia && firstMedia.type === 'video') {
                     // Use a video placeholder for the card if only video is available
                     cardImageUrl = 'https://placehold.co/600x400/4f46e5/ffffff?text=Video+Available'; 
                }
                cardPrice = product.variants[0].price;
            }
            
            // Note the use of onclick="showProductDetails('${product.id}')"
            return `
                <div class="bg-white rounded-xl shadow-lg hover:shadow-2xl transition duration-300 overflow-hidden transform hover:-translate-y-1">
                    <img
                        src="${cardImageUrl}"
                        alt="Image of ${product.name}"
                        class="w-full h-48 object-cover object-center"
                        onerror="this.onerror=null; this.src='https://placehold.co/600x400/e0e0e0/333333?text=Image+Not+Found';"
                    >
                    <div class="p-6">
                        <h2 class="text-2xl font-semibold text-gray-900 mb-2">${product.name}</h2>
                        <p class="text-indigo-600 text-xl font-bold mb-4">${cardPrice}</p>
                    </div>
                    <div class="p-6 pt-0">
                        <button onclick="showProductDetails('${product.id}')" class="w-full py-3 bg-indigo-500 text-white font-medium rounded-lg hover:bg-indigo-600 transition duration-150 shadow-md">
                            View Details
                        </button>
                    </div>
                </div>
            `;
        }

        /**
         * Renders all product cards to the catalog grid.
         */
        function renderCatalog() {
            if (!catalogGrid) return;
            const catalogHtml = products.map(createProductCard).join('');
            catalogGrid.innerHTML = catalogHtml;
        }

        /**
         * Checks the URL hash on load to see if a specific product should be displayed immediately.
         */
        function checkInitialHash() {
            const productId = window.location.hash.substring(1);
            if (productId) {
                showProductDetails(productId);
            } else {
                showCatalogGrid();
            }
        }

        // Initialize the catalog display and check the hash on page load
        document.addEventListener('DOMContentLoaded', () => {
            renderCatalog();
            checkInitialHash();
        });

        // Listen for hash changes (e.g., browser back button)
        window.addEventListener('hashchange', () => {
            checkInitialHash();
        });
    </script>

</body>
</html>

